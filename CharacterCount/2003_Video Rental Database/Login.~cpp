//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Login.h"
#include "Main.h"
#include "AdminControl.h"

//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TfrmLogin *frmLogin;
int attemptedFailures;
//---------------------------------------------------------------------------
__fastcall TfrmLogin::TfrmLogin(TComponent* Owner)
        : TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TfrmLogin::cmdLoginClick(TObject *Sender)
{
        if((txtAccount->Text == "JDOE") && (txtPassword->Text == "letmein")){
            attemptedFailures = 0;
            frmMain->Show();
            frmMain->txtMovieName->SetFocus();
            frmLogin->Hide();
            txtAccount->Clear();
            txtPassword->Clear();
            txtAdminCode->Clear();
        }
        else{
                ++attemptedFailures;
                txtAccount->Clear();
                txtPassword->Clear();
                txtAdminCode->Clear();
                txtAccount->SetFocus();
        }
        if(attemptedFailures > 2)
                Application->Terminate();
}
//---------------------------------------------------------------------------

void __fastcall TfrmLogin::cmdClearClick(TObject *Sender)
{
        txtAccount->Clear();
        txtPassword->Clear();
        txtAdminCode->Clear();
        txtAccount->SetFocus();
}
//---------------------------------------------------------------------------


void __fastcall TfrmLogin::tmrLoginTimer(TObject *Sender)
{
        if(frmLogin->txtAccount->Focused()) txtAccount->Color = clYellow;
        else txtAccount->Color = clWhite;
        if(frmLogin->txtPassword->Focused()) txtPassword->Color = clYellow;
        else txtPassword->Color = clWhite;
        if(frmLogin->txtAdminCode->Focused()) txtAdminCode->Color = clYellow;
        else txtAdminCode->Color = clWhite;
}
//---------------------------------------------------------------------------

void __fastcall TfrmLogin::cmdCancelClick(TObject *Sender)
{
        Application->Terminate();
}
//---------------------------------------------------------------------------

void __fastcall TfrmLogin::cmdAdminClick(TObject *Sender)
{
        if(txtAccount->Text == "ASARKISIAN" && txtPassword->Text == "rose99" && txtAdminCode->Text == "3002"){
            attemptedFailures = 0;
            frmAdminControl->Show();
            frmAdminControl->txtSocialSecurity->SetFocus();
            frmLogin->Hide();
            txtAccount->Clear();
            txtPassword->Clear();
            txtAdminCode->Clear();
        }
        else{
               ++attemptedFailures;
                txtAccount->Clear();
                txtPassword->Clear();
                txtAdminCode->Clear();
                txtAccount->SetFocus();
        }
        if(attemptedFailures > 2)
                Application->Terminate();
}
//---------------------------------------------------------------------------
